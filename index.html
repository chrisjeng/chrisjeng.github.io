<html>
<body>
<script src="pixi.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.8.3.min.js"><\/script>')</script>
<script>
  var width = 800;
  var height = 600;
  var stage = new PIXI.Container();
  var foodTexture = PIXI.Texture.fromImage('assets/img/bunny.png');
  var characterTexture = PIXI.Texture.fromImage('assets/img/soup.jpg');
  var renderer = PIXI.autoDetectRenderer(width, height,{backgroundColor : 0x1099bb});
  var backgroundTile = new PIXI.extras.TilingSprite(foodTexture, renderer.width, renderer.height);
  backgroundTile.tileScale.x = 0.05;
  backgroundTile.tileScale.y = 0.05;
  stage.addChild(backgroundTile);
  document.body.appendChild(renderer.view);

  // create a texture from an image path
  var foods = [];
  var chicken = new PIXI.Sprite(characterTexture);
  chicken.anchor.x = 0.0;
  chicken.anchor.y = 0.0;
  chicken.position.x = 300;
  chicken.position.y = 400;
  chicken.scale.x = 0.6;
  chicken.scale.y = 0.6;
  stage.addChild(chicken);
  var score = 0;
  var text = new PIXI.Text(score, {font : '24px Arial', fill : 0x000000, align : 'center'});
  stage.addChild(text);

  $(renderer.view).mousedown(function(e) {
    var x = e.offsetX;
    var y = e.offsetY;
    var food = new PIXI.Sprite(foodTexture);
    food.scale.x = 0.15;
    food.scale.y = 0.15;
    food.position.x = x;
    food.position.y = y;
    foods.push(food);
    stage.addChild(food);
  });

  // $(renderer.view).mouseup(function(e) {
  //   console.log(e);
  // });

  // start animating
  animate();
  function animate() {
    requestAnimationFrame(animate);
    checkFoodPositions();
    text.text = score;
    // render the container
    renderer.render(stage);
  }

  function checkFoodPositions() {
    for (var i = 0; i < foods.length; i++) {
      foods[i].position.y += 3;
      if (foods[i].position.y > 600) {
        removeFood(foods[i]);
      }
      else if (checkCollision(chicken, foods[i])) {
        removeFood(foods[i]);
        score++;
      }
    }
  }

  function removeFood(food) {
    stage.removeChild(food);
    i = foods.indexOf(food);
    foods.splice(i, 1);
  }

  function checkCollision(a, b) {
    return !(b.position.x > (a.position.x + a.width) ||
            (b.position.x + b.width) < a.position.x ||
             b.position.y > (a.position.y + a.height) ||
            (b.position.y + b.height) < a.position.y);
  }
</script>
</body>
</html
