<html>
<body>
<script src="pixi.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.8.3.min.js"><\/script>')</script>
<script>
  var level = 0;
  var foodCount = 0;
  var timeElapsed = 0;
  var width = 800;
  var height = 600;
  var chickenWeight = 100;
  var stage = new PIXI.Container();
  var foodTexture = PIXI.Texture.fromImage('assets/img/bunny.png');
  var characterTexture = PIXI.Texture.fromImage('assets/img/test_chrischiken/chris.png');
  var renderer = PIXI.autoDetectRenderer(width, height,{backgroundColor : 0x1099bb});
  var backgroundTile = new PIXI.extras.TilingSprite(foodTexture, renderer.width, renderer.height);
  backgroundTile.tileScale.x = 0.05;
  backgroundTile.tileScale.y = 0.05;
  stage.addChild(backgroundTile);
  document.body.appendChild(renderer.view);

  // create a texture from an image path
  var foods = [];
  var chicken = new PIXI.Sprite(characterTexture);
  chicken.anchor.x = 0.0;
  chicken.anchor.y = 0.0;
  chicken.position.x = 300;
  chicken.position.y = 400;
  chicken.scale.x = 0.2;
  chicken.scale.y = 0.2;
  stage.addChild(chicken);
  var score = 0;
  var text = new PIXI.Text(score, {font : '24px Arial', fill : 0x000000, align : 'center'});
  stage.addChild(text);

  // display the heart logo at 100%
  var heartTexture = PIXI.Texture.fromImage('assets/img/heart/heart100.png');
  var heart = new PIXI.Sprite(heartTexture);
  // hard coded values
  heart.height = 50;
  heart.width = 50;
  heart.anchor.x = 0.5;
  heart.anchor.y = 0.5;
  heart.position.x = 700;
  heart.position.y = 400;
  stage.addChild(heart);

  // display the hunger logo at 100%
  var hungerTexture = PIXI.Texture.fromImage('assets/img/hunger/hunger100.png');
  var hunger = new PIXI.Sprite(hungerTexture);
  // hard coded values
  hunger.height = 50;
  hunger.width = 50;
  hunger.anchor.x = 0.5;
  hunger.anchor.y = 0.5;
  hunger.position.x = 700;
  hunger.position.y = 480;
  stage.addChild(hunger);

  $(renderer.view).mousedown(function(e) {
    var x = e.offsetX;
    var y = e.offsetY;
    var food = new PIXI.Sprite(foodTexture);
    food.scale.x = 0.15;
    food.scale.y = 0.15;
    food.position.x = x;
    food.position.y = y;
    foods.push(food);
    stage.addChild(food);
  });

  // $(renderer.view).mouseup(function(e) {
  //   console.log(e);
  // });

  // start animating
  animate();
  function animate() {
    var seconds = ++timeElapsed/60;
    requestAnimationFrame(animate);
    checkFoodPositions();
    text.text = score;
    // render the container
    renderer.render(stage);
  }

  function checkFoodPositions() {
    for (var i = 0; i < foods.length; i++) {
      foods[i].position.y += 3;
      if (foods[i].position.y > 600) {
        removeFood(foods[i]);
      }
      else if (checkCollision(chicken, foods[i])) {
        removeFood(foods[i]);
        if (++foodCount == 2) {
          makeChickenFat(++level);
          foodCount = 0;
          seconds = 0;
        }
        score++;
      }
    }
  }

  function makeChickenFat(level) {
    switch(level) {
      case -4:
        chicken.texture = PIXI.Texture.fromImage('assets/img/test_chrischiken/chrisskinny400.png');
        break;
      case -3:
        chicken.texture = PIXI.Texture.fromImage('assets/img/test_chrischiken/chrisskinny300.png');
        break;
      case -2:
        chicken.texture = PIXI.Texture.fromImage('assets/img/test_chrischiken/chrisskinny200.png');
        break;
      case -1:
        chicken.texture = PIXI.Texture.fromImage('assets/img/test_chrischiken/chrisskinny100.png');
        break;
      case 0:
        chicken.texture = PIXI.Texture.fromImage('assets/img/test_chrischiken/chris.png');
        break;
      case 1:
        chicken.texture = PIXI.Texture.fromImage('assets/img/test_chrischiken/chrisfat100.png');
        break;
      case 2:
        chicken.texture = PIXI.Texture.fromImage('assets/img/test_chrischiken/chrisfat200.png');
        break;
      case 3:
        chicken.texture = PIXI.Texture.fromImage('assets/img/test_chrischiken/chrisfat300.png');
        break;
      case 4:
        chicken.texture = PIXI.Texture.fromImage('assets/img/test_chrischiken/chrisfat400.png');
        break;
    }
  }

  function removeFood(food) {
    stage.removeChild(food);
    i = foods.indexOf(food);
    foods.splice(i, 1);
  }

  function checkCollision(a, b) {
    return !(b.position.x > (a.position.x + a.width) ||
            (b.position.x + b.width) < a.position.x ||
             b.position.y > (a.position.y + a.height) ||
            (b.position.y + b.height) < a.position.y);
  }

  // updates chicken weight with the given value! aka feed chicken
  function feedChicken(foodValue){
    chickenWeight += foodValue;
    if(chickenWeight > 100){
      chickenWeight = 100;
    }
    setHungerLevel(chickenWeight);
  }

  // replaces the hunger icon with the appropriate icon
  function setHungerLevel(hungerLevel) {
    if(hungerLevel == 0){
      hunger.texture = PIXI.Texture.fromImage('assets/img/hunger/hunger0.png');
    } else if(hungerLevel > 0 && hungerLevel < 25){
      hunger.texture = PIXI.Texture.fromImage('assets/img/hunger/hunger25.png');
    } else if(hungerLevel >= 25 && hungerLevel < 50) {
      hunger.texture = PIXI.Texture.fromImage('assets/img/hunger/hunger50.png');
    } else if(hungerLevel >= 50 && hungerLevel < 75){
      hunger.texture = PIXI.Texture.fromImage('assets/img/hunger/hunger75.png');
    } else if(hungerLevel >= 75 && hungerLevel <= 100){
      hunger.texture = PIXI.Texture.fromImage('assets/img/hunger/hunger100.png');
    }
  }

  // replaces the love icon with the appropriate icon
  function setLoveLevel(loveLevel) {
    if(loveLevel == 0){
      heart.texture = PIXI.Texture.fromImage('assets/img/heart/heart0.png');
    } else if(loveLevel > 0 && loveLevel < 25){
      heart.texture = PIXI.Texture.fromImage('assets/img/heart/heart25.png');
    } else if(loveLevel >= 25 && loveLevel < 50) {
      heart.texture = PIXI.Texture.fromImage('assets/img/heart/heart50.png');
    } else if(loveLevel >= 50 && loveLevel < 75){
      heart.texture = PIXI.Texture.fromImage('assets/img/heart/heart75.png');
    } else if(loveLevel >= 75 && loveLevel <= 100){
      heart.texture = PIXI.Texture.fromImage('assets/img/heart/heart100.png');
    }
  }
</script>
</body>
</html
